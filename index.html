const tiles = Array.from(document.querySelectorAll('.tile'));
const gameBoard = document.getElementById('gameBoard');
let emptyTile = document.querySelector('.empty');

tiles.forEach(tile => {
    tile.addEventListener('touchstart', handleTouchStart);
});

function handleTouchStart(e) {
    const tile = e.target;
    const tileIndex = tiles.indexOf(tile);
    const emptyIndex = tiles.indexOf(emptyTile);

    if (canMove(tileIndex, emptyIndex)) {
        swapTiles(tile, emptyTile);
    }
}

function canMove(tileIndex, emptyIndex) {
    const rowSize = 4;
    const isAdjacent =
        tileIndex === emptyIndex - 1 && emptyIndex % rowSize !== 0 ||
        tileIndex === emptyIndex + 1 && tileIndex % rowSize !== 0 ||
        tileIndex === emptyIndex - rowSize ||
        tileIndex === emptyIndex + rowSize;

    return isAdjacent;
}

function swapTiles(tile, emptyTile) {
    const tempOrder = tile.style.order;
    tile.style.order = emptyTile.style.order;
    emptyTile.style.order = tempOrder;

    // Swap positions in the array
    const tileIndex = tiles.indexOf(tile);
    const emptyIndex = tiles.indexOf(emptyTile);
    tiles[tileIndex] = emptyTile;
    tiles[emptyIndex] = tile;
}

// Ensure the order property is set on all tiles
tiles.forEach((tile, index) => {
    tile.style.order = index;
});
